<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›™å¾Œç«¯æœå‹™æ¯”è¼ƒå·¥å…· v2.0</title>
    <style>
        /* ä¿æŒåŸæœ‰æ¨£å¼ï¼Œæ·»åŠ æ–°åŠŸèƒ½æ¨£å¼ */
        .quick-load {
            background: #e3f2fd;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }

        .service-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .service-btn {
            padding: 8px 16px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .service-btn:hover {
            background: #1976d2;
        }

        .export-section {
            margin-top: 20px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
        }

        .export-btn {
            padding: 8px 16px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }

        .input-section {
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            /* æ¡Œé¢ç‰ˆ 2 åˆ— */
            gap: 1rem;
        }

        /* æ´»å‹•é …ç›®å®¹å™¨ - ä½¿ç”¨ Grid ä½ˆå±€ */
        .activities-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            /* æ¡Œé¢ç‰ˆ 2 åˆ— */
            gap: 1rem;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group h3 {
            margin-bottom: 10px;
        }

        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
        }

        button {
            padding: 10px 20px;
            background: #2196f3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background: #1976d2;
        }

        #results {
            margin-top: 20px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
        }
    </style>
</head>

<body>
    <!-- ä¿æŒåŸæœ‰ HTML çµæ§‹ï¼Œåœ¨ input-section ä¸­æ·»åŠ  -->
    <div class="quick-load">
        <h3>ğŸš€ å¿«é€Ÿè¼‰å…¥æœå‹™</h3>
        <p>é»æ“ŠæŒ‰éˆ•è‡ªå‹•è¼‰å…¥å°æ‡‰çš„æœå‹™ä»£ç¢¼é€²è¡Œæ¯”è¼ƒ</p>
        <div class="service-buttons">
            <button class="service-btn" onclick="loadService('activity')">Activity Service</button>
            <button class="service-btn" onclick="loadService('registration')">Registration Service</button>
            <button class="service-btn" onclick="loadService('monthlyDonate')">Monthly Donate Service</button>
            <button class="service-btn" onclick="loadService('joinRecord')">Join Record Service</button>
        </div>
    </div>

    <div class="input-section">
        <div class="input-group">
            <h3>Directus æœå‹™ä»£ç¢¼</h3>
            <textarea id="directusCode" rows="15" placeholder="è²¼ä¸Š Directus æœå‹™ä»£ç¢¼..."></textarea>
        </div>
        <div class="input-group">
            <h3>Rust æœå‹™ä»£ç¢¼</h3>
            <textarea id="rustCode" rows="15" placeholder="è²¼ä¸Š Rust æœå‹™ä»£ç¢¼..."></textarea>
        </div>
        <button onclick="compareServices()">æ¯”è¼ƒæœå‹™</button>
    </div>

    <div id="results"></div>

    <script>
        // æœå‹™ä»£ç¢¼æ¨¡æ¿ï¼ˆå¯¦éš›ä½¿ç”¨æ™‚éœ€è¦å¾æ–‡ä»¶è®€å–ï¼‰
        const serviceTemplates = {
            activity: {
                directus: `// Activity Service ä»£ç¢¼ç¤ºä¾‹
export class ActivityService {
    async createActivity(data) {}
    async getAllActivities() {}
    async getActivityById(id) {}
    async updateActivity(id, data) {}
    async deleteActivity(id) {}
}`,
                rust: `// Rust Activity Service ä»£ç¢¼ç¤ºä¾‹
export class RustActivityService {
    async createActivity(data) {}
    async getAllActivities() {}
    async getActivityById(id) {}
    async updateActivity(id, data) {}
    async deleteActivity(id) {}
    async batchOperations(ops) {} // Rust ç‰¹æœ‰
}`
            },
            joinRecord: {
                directus: `// Join Record Service ä»£ç¢¼ç¤ºä¾‹
export class JoinRecordService {
    async createParticipationRecord(data) {}
    async getAllParticipationRecords() {}
    async getParticipationRecordById(id) {}
    async updateParticipationRecord(id, data) {}
    async deleteParticipationRecord(id) {}
    async saveRecord(payload) {}
}`,
                rust: `// Rust Join Record Service ä»£ç¢¼ç¤ºä¾‹
export class RustJoinRecordService {
    async createParticipationRecord(data) {}
    async getAllParticipationRecords() {}
    async getParticipationRecordById(id) {}
    async updateParticipationRecord(id, data) {}
    async deleteParticipationRecord(id) {}
    async saveRecord(payload) {}
    async batchOperations(ops) {} // Rust ç‰¹æœ‰
}`
            }
        };

        function loadService(serviceName) {
            const template = serviceTemplates[serviceName];
            if (template) {
                document.getElementById('directusCode').value = template.directus;
                document.getElementById('rustCode').value = template.rust;
                compareServices(); // è‡ªå‹•æ¯”è¼ƒ
            }
        }

        function compareServices() {
            const directusCode = document.getElementById('directusCode').value;
            const rustCode = document.getElementById('rustCode').value;

            if (!directusCode || !rustCode) {
                alert('è«‹è¼¸å…¥å…©å€‹æœå‹™çš„ä»£ç¢¼ï¼');
                return;
            }

            const results = {
                directusMethods: extractMethods(directusCode),
                rustMethods: extractMethods(rustCode),
                timestamp: new Date().toISOString()
            };

            displayResults(results);
        }

        function extractMethods(code) {
            const methodRegex = /async\s+(\w+)\s*\([^)]*\)/g;
            const methods = [];
            let match;

            while ((match = methodRegex.exec(code)) !== null) {
                methods.push(match[1]);
            }

            return methods;
        }

        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            const directusOnly = data.directusMethods.filter(m => !data.rustMethods.includes(m));
            const rustOnly = data.rustMethods.filter(m => !data.directusMethods.includes(m));
            const common = data.directusMethods.filter(m => data.rustMethods.includes(m));

            resultsDiv.innerHTML = `
                <h3>ğŸ“Š æ¯”è¼ƒçµæœ</h3>
                <div><strong>å…±åŒæ–¹æ³• (${common.length}):</strong> ${common.join(', ') || 'ç„¡'}</div>
                <div><strong>åƒ… Directus (${directusOnly.length}):</strong> ${directusOnly.join(', ') || 'ç„¡'}</div>
                <div><strong>åƒ… Rust (${rustOnly.length}):</strong> ${rustOnly.join(', ') || 'ç„¡'}</div>
                
                <div class="export-section">
                    <h3>ğŸ“¤ å°å‡ºçµæœ</h3>
                    <button class="export-btn" onclick="exportResults('json')">å°å‡º JSON</button>
                    <button class="export-btn" onclick="exportResults('csv')">å°å‡º CSV</button>
                </div>
            `;
        }

        function exportResults(format) {
            const results = getCurrentResults();
            if (!results) {
                alert('è«‹å…ˆé€²è¡Œæ¯”è¼ƒï¼');
                return;
            }

            if (format === 'json') {
                const blob = new Blob([JSON.stringify(results, null, 2)],
                    { type: 'application/json' });
                downloadFile(blob, 'service-comparison.json');
            } else if (format === 'csv') {
                const csv = generateCSV(results);
                const blob = new Blob([csv], { type: 'text/csv' });
                downloadFile(blob, 'service-comparison.csv');
            }
        }

        function downloadFile(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        // åœ¨åŸæœ‰çš„ displayResults å‡½æ•¸æœ«å°¾æ·»åŠ å°å‡ºæŒ‰éˆ•
        function displayResults(data) {
            // ... åŸæœ‰ä»£ç¢¼ ...

            const exportSection = `
                <div class="export-section">
                    <h3>ğŸ“¤ å°å‡ºçµæœ</h3>
                    <button class="export-btn" onclick="exportResults('json')">å°å‡º JSON</button>
                    <button class="export-btn" onclick="exportResults('csv')">å°å‡º CSV</button>
                </div>
            `;

            resultsDiv.innerHTML += exportSection;
        }
    </script>
</body>

</html>