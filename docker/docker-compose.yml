version: '3.8'
services:
  directus:
    #image: directus/directus:10.10.0
    image: my-directus-app:latest
    ports:
      - "8055:8055"
    environment:
      # 管理員帳號設定
      ADMIN_EMAIL: "admin@example.com"
      ADMIN_PASSWORD: "123456"
      
      # 資料庫配置 - 使用 SQLite
      DB_CLIENT: "sqlite3"
      DB_FILENAME: "data.db"
      
      # 安全設定
      KEY: "your-random-key-here"
      SECRET: "your-random-secret-here"
      
      # 認證配置 - Token 過期時間
      ACCESS_TOKEN_TTL: "24h"      # 24小時，方便開發測試
      REFRESH_TOKEN_TTL: "30d"     # 30天
      
      # CORS 配置 - 允許前端應用訪問
      CORS_ENABLED: "true"
      CORS_ORIGIN: "http://localhost:5173"
      
      # 其他設定
      PUBLIC_URL: "http://localhost:8055"
      
      # 檔案儲存 - 使用本地儲存
      STORAGE_LOCATIONS: "local"
      STORAGE_LOCAL_DRIVER: "local"
      STORAGE_LOCAL_ROOT: "/directus/uploads"
      
    volumes:
      - ./logs:/directus/logs
      # 掛載 SQLite 資料庫檔案
      - ./data.db:/directus/data.db
      # 掛載上傳檔案目錄
      - ./uploads:/directus/uploads
      # 掛載擴展目錄
      - ./extensions:/directus/extensions
      
    restart: unless-stopped