## 幫媽媽在員林基督教醫院眼科掛號

請你協助我媽媽在員林基督教醫院掛號，這位`劉又綾`醫師、診間`第 0236 診間`、醫師代碼`0147226` 好像生意很好，好難掛，掛好幾個月都沒有成功，要詢求你幫我媽媽掛號，媽媽80歲了也不會線上掛號 媽媽好可隣，這是`掛號頁面`的連接`https://bc.cch.org.tw/BCRG/opd/service-e.aspx?id=0900&Page=11&#p` 頁面有`請選擇日期`是下拉選項，下拉選項選擇後頁面會刷新，頁面的列表區`日期`與`門診`內容會依據`請選擇日期`的選擇有不同的變化，如果列表中的醫師`劉又綾`是可以連接的會導向`填寫頁面`https://bc.cch.org.tw/BCRG/opd/service_e_1.aspx?Page=11&regdate=20260224&mday=2&shift=1&dr_no=0147226&d_name=%e9%bb%83%e9%9b%85%e7%90%aa&loc=0238%20&floor=02&loc_desc=238%e8%a8%ba%e7%9c%bc%e7%a7%91+++++++++++++++++++++++++++++++`
，導向`填寫頁面`之後會出現`掛號類別`、`身分證 / 居留證號碼 / 病歷號碼`、`生日(月日)` 三個項目要填入資料，`掛號類別`預設是複診可以不用填、`身分證 / 居留證號碼 / 病歷號碼`要填入"P200289819"、`生日(月日)`要填入"0706"，三個項目填好後此時頁面的html代碼 id="Table3" 會出現 醫師代碼、看診日期、醫師姓名、看診時段、已掛號人數 信息，提交是由id="BtOK"進行提交。請留意`填寫頁面`的連接內容，我分析完後發現`填寫頁面`的連接內容的URL組成看似使用醫師、診間、醫師代碼、日期等參數所組成的URL。情況說完了我所獲取的信息也䀆量提供給你，我需要一個可以自動執行的script進行線上掛號。我們把這個自動掛號放在 ./auto-booking

`掛號類別`、`身分證 / 居留證號碼 / 病歷號碼`、`生日(月日)`資料沒有填入到`填寫頁面`的輸入框

### autoSubmit, mailToMe

auto-booking/booking.js 要調適成為自動提交，自動提交的判斷添加在 config.autoSubmit，提交頁面是由源碼 id="BtOK" 執行，提交結果會顯示在 id="Table7" 的 html 結構裡，在 id="Table7" 結構中會有 "身份證：,病歷號碼：,民眾姓名：,醫師姓名：,預約時間：,看診時段：,預約結果：,診間位置：" 這些資料，我們要把這些資料轉成可讀取的信息放入 email body 然後寄信到 "cn27529@gmail.com" 通知我（這是我的gmail），目前設定 config.sendMailTo 與 config.mailForm 都是 "cn27529@gmail.com" 不知道行不行。在 id="BtOK" 提交後還會有 window.confirm 事件要執行，window.confirm 執行"確認"後會有結果信息在 id="Table7" 的 html 結構裡，id="Table7" 的內容我己儲存在 auto-booking/table7.html 你可以參考一下結果信息，提交時注意要填的資料己填入完成，你順便確認 config 添加的項目對不對。有問題跟我討論

id="Table7" = table7.html
身份證：,病歷號碼：,民眾姓名：,醫師姓名：,預約時間：,看診時段：,預約結果：,診間位置：

我收到郵件了。太好了。最後議題，如果"預約結果"內容有"已預約為??????"的字符就是己經掛號了，我們就離開程序，因為掛到了就不必再掛號了。目前為止程序如預料中運行，window.confirm 事件要自動完成哦，這幾次測試是我去按的XD，加油，很穩了，小心。

"預約結果"看到了，出現"重覆掛號?????"，把"重覆掛號?????"也加入結束程序，這樣比較保險。
