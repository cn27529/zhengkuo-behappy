# Token 計算方式與優化使用指南

## Token 基本概念

### 什麼是 Token
- **定義**: Token 是 AI 模型處理文本的基本單位
- **中文計算**: 通常 1 個中文字 ≈ 1-2 個 tokens
- **英文計算**: 通常 1 個英文單詞 ≈ 1-4 個 tokens
- **代碼計算**: 代碼中的符號、關鍵字都會計算為 tokens

### Token 計費方式
- **輸入 Token**: 您發送給 AI 的內容
- **輸出 Token**: AI 回覆給您的內容
- **總消耗**: 輸入 + 輸出 = 單次對話總 token 數

## Token 計算實例

### 文本範例
```
"請幫我寫一個 Vue 組件" 
≈ 12 個 tokens

"Please help me write a Vue component"
≈ 8 個 tokens
```

### 代碼範例
```javascript
const handlePrint = () => {
  console.log("print");
};
```
≈ 25-30 個 tokens

## 影響 Token 消耗的因素

### 1. 對話歷史
- **累積效應**: 每次對話都包含之前的歷史
- **長對話**: 隨著對話進行，token 消耗會增加
- **上下文**: 系統需要理解完整對話脈絡

### 2. 代碼文件大小
- **文件讀取**: 使用工具讀取大文件會消耗大量 tokens
- **代碼分析**: 複雜的代碼結構需要更多 tokens 理解
- **多文件操作**: 同時處理多個文件會快速累積

### 3. 輸出長度
- **詳細回答**: 要求詳細說明會產生更多輸出 tokens
- **代碼生成**: 生成完整代碼比簡單回答消耗更多
- **文檔生成**: 如本文檔的生成也會消耗較多 tokens

## Token 優化策略

### 1. 精簡提問
```
❌ 不佳: "請詳細說明如何在 Vue.js 中實現一個複雜的表單組件，包括所有可能的功能和最佳實踐"

✅ 良好: "Vue 表單組件基本實現"
```

### 2. 分段處理
```
❌ 一次性: "幫我完成整個系統的前端和後端"

✅ 分步驟: 
- 先完成前端組件
- 再處理後端 API
- 最後整合測試
```

### 3. 避免重複讀取
```
❌ 每次都讀取: 重複要求讀取同一個大文件

✅ 一次讀取: 在一次對話中完成所有相關操作
```

### 4. 使用簡潔語言
```
❌ 冗長: "我現在遇到了一個非常複雜的問題，需要您幫助我..."

✅ 直接: "報錯: TypeError: Cannot read properties..."
```

## 實用優化技巧

### 1. 重新開始對話
- **時機**: 當對話變得很長時
- **好處**: 清除歷史，減少 token 消耗
- **注意**: 會失去上下文，需要重新說明背景

### 2. 精確指定需求
```
✅ 具體: "修改第 25 行的錯誤處理"
❌ 模糊: "幫我改善這個代碼"
```

### 3. 使用代碼片段
```
✅ 只貼相關代碼: 
const handlePrint = (item) => {
  // 只貼有問題的部分
};

❌ 貼整個文件: 包含大量無關代碼
```

### 4. 批量處理
```
✅ 一次處理多個相似問題:
"修復以下 3 個類似的錯誤: 1... 2... 3..."

❌ 分別提問: 每個錯誤單獨問一次
```

## 監控 Token 使用

### 1. AWS 控制台
- 進入 Bedrock 服務頁面
- 查看使用量和計費詳情
- 設置使用量警報

### 2. 使用量估算
- **短對話**: 約 100-500 tokens
- **中等對話**: 約 500-2000 tokens  
- **長對話**: 約 2000-8000 tokens
- **代碼生成**: 約 1000-5000 tokens

### 3. 成本控制
- 設置每日/每月使用限額
- 定期檢查使用報告
- 優化對話策略

## 最佳實踐建議

### 1. 開發階段
- 先用簡短對話測試想法
- 確認方向正確後再詳細實現
- 避免反覆修改大段代碼

### 2. 問題解決
- 先提供錯誤信息和關鍵代碼
- 避免貼出整個項目文件
- 一次解決一個主要問題

### 3. 學習使用
- 問具體技術問題而非概念解釋
- 要求代碼示例而非長篇理論
- 利用現有代碼模式而非從零開始

## 總結

Token 優化的核心是**精準和高效**：
- 明確表達需求
- 避免不必要的冗長
- 合理利用對話歷史
- 分步驟處理複雜任務

通過這些策略，您可以在保持開發效率的同時，有效控制 token 消耗成本。
